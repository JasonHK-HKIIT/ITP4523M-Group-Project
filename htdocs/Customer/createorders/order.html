<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Order</title>
    <link rel="stylesheet" href="C:\Users\1\ITP4523M-Group-Project\htdocs\assets\bulma.min.css">
    <script src="C:\Users\1\ITP4523M-Group-Project\htdocs/assets/navbar.js" defer async></script>
    <script src="C:\Users\1\ITP4523M-Group-Project\htdocs/assets/fontawesome/js/solid.min.js" defer></script>
    <script src="C:\Users\1\ITP4523M-Group-Project\htdocs/assets/fontawesome/js/duotone.min.js" defer></script>
    <script src="C:\Users\1\ITP4523M-Group-Project\htdocs/assets/fontawesome/js/fontawesome.min.js" defer></script>
</head>

<body>
    <nav class="navbar is-spaced has-shadow">
        <div class="navbar-brand">
            <a class="navbar-item" href="/admin">
                <i class="fa-duotone fa-solid fa-teddy-bear"></i>
                Smile & Sunshine Toy Co. Ltd.
            </a>
            <a class="navbar-burger" data-target="menu">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        <div id="menu" class="navbar-menu">
            <div class="navbar-start">
                <a class="navbar-item">Home</a>
                <a class="navbar-item">Create Orders</a>
                <a class="navbar-item">View Order</a>
                <a class="navbar-item">Update Customer</a>
            </div>

            <div class="navbar-end">
                <a class="navbar-item">Log Out</a>
            </div>
        </div>
    </nav>
    <header class="hero is-primary is-medium">
        <div class="hero-body container is-max-desktop">
            <h1 class="title">
                Create Order
            </h1>
        </div>
    </header>
    <div class="box">
        <div class="columns">
            <div class="column is-8">
                <h1 class="title is-2">Choose Product</h1>

                <div class="list">
                    <div class="list-item box">
                        <div class="list-item-image">
                            <figure class="image is-96x96">
                                <img src="C:\Users\1\ITP4523M-Group-Project\htdocs/assets/products/1.jpg"
                                    alt="ProductID:1">
                            </figure>
                        </div>
                        <div class="list-item-content">
                            <div class="list-item-title">Toy Car</div>
                            <div class="list-item-description">Price: $20.00 | Stock: 20</div>
                        </div>
                        <div class="list-item-controls">
                            <div class="buttons is-right">
                                <button class="button" onclick="addToOrder(this,'Toy Car',20,'PRD01')">
                                    <span class="icon">
                                        <i class="fas fa-cart-plus"></i>
                                    </span>
                                    <span>Add</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="list">
                    <div class="list-item box">
                        <div class="list-item-image">
                            <figure class="image is-96x96">
                                <img src="C:\Users\1\ITP4523M-Group-Project\htdocs/assets/products/1.jpg"
                                    alt="ProductID:1">
                            </figure>
                        </div>
                        <div class="list-item-content">
                            <div class="list-item-title">Toy Car</div>
                            <div class="list-item-description">Price: $20.00 | Stock: 20</div>
                        </div>
                        <div class="list-item-controls">
                            <div class="buttons is-right">
                                <button class="button" onclick="addToOrder(this,'Toy Car',20,'PRD01')">
                                    <span class="icon">
                                        <i class="fas fa-cart-plus"></i>
                                    </span>
                                    <span>Add</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="list">
                    <div class="list-item box">
                        <div class="list-item-image">
                            <figure class="image is-96x96">
                                <img src="C:\Users\1\ITP4523M-Group-Project\htdocs/assets/products/1.jpg"
                                    alt="ProductID:1">
                            </figure>
                        </div>
                        <div class="list-item-content">
                            <div class="list-item-title">Toy Car</div>
                            <div class="list-item-description">Price: $20.00 | Stock: 20</div>
                        </div>
                        <div class="list-item-controls">
                            <div class="buttons is-right">
                                <button class="button" onclick="addToOrder(this,'Toy Car',20,'PRD01')">
                                    <span class="icon">
                                        <i class="fas fa-cart-plus"></i>
                                    </span>
                                    <span>Add</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="box">
                    <h2 class="title is-4">Product Order</h2>

                    <table class="table is-fullwidth">
                        <thead>
                            <tr>
                                <th>OrderID</th>
                                <th>Product</th>
                                <th>Quantitu</th>
                                <th>Price</th>
                            </tr>
                        </thead>
                        <tbody id="order-items">
                        </tbody>
                        <tfoot>
                            <tr>
                                <th>Total</th>
                                <th id="total-quantity">0</th>
                                <th id="total-price">Â¥0.00</th>
                                <th></th>
                            </tr>
                        </tfoot>
                    </table>
                </div>


                <a href="C:\Users\1\ITP4523M-Group-Project\htdocs\Customer\createorders\SubmitSuccess.html" class="button is-success box has-text-centered"> 
                 <span class="icon">
                     <i class="fas fa-check"></i>
                 </span>
                 <span>Submit Order</span>
                </a>

                <div class="field mt-5">
                    <div class="control">
                        <button class="button is-light" onclick="clearOrder()">
                            <span class="icon">
                                <i class="fas fa-trash"></i>
                            </span>
                            <span>Clear</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <script>

            let orderItems = [];

           function addToOrder(button, productName, price, productId) {
                const existingItem = orderItems.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    orderItems.push({
                        id: productId,
                        name: productName,
                        price: price,
                        quantity: 1
                    });
                }

                updateOrderDisplay();
            }


            function updateOrderDisplay() {
                const orderTable = document.getElementById('order-items');
                let totalQuantity = 0;
                let totalPrice = 0;

                orderTable.innerHTML = '';


                orderItems.forEach(item => {
                    const row = document.createElement('tr');

                    row.innerHTML = `
                        <td>${item.id}</td>
                        <td>${item.name}</td>
                        <td>
                            <div class="field has-addons">
                                <div class="control">
                                    <button class="button is-small" onclick="adjustQuantity('${item.id}', -1)">
                                        <span class="icon is-small">
                                            <i class="fas fa-minus"></i>
                                        </span>
                                    </button>
                                </div>
                                <div class="control">
                                    <input class="input is-small" type="number" value="${item.quantity}" min="1" 
                                           onchange="updateQuantity('${item.id}', this.value)" style="width: 60px; text-align: center">
                                </div>
                                <div class="control">
                                    <button class="button is-small" onclick="adjustQuantity('${item.id}', 1)">
                                        <span class="icon is-small">
                                            <i class="fas fa-plus"></i>
                                        </span>
                                    </button>
                                </div>
                            </div>
                        </td>
                        <td>$${(item.price * item.quantity).toFixed(2)}</td>
                        <td>
                            <button class="button is-small is-danger" onclick="removeItem('${item.id}')">
                                <span class="icon is-small">
                                    <i class="fas fa-trash"></i>
                                </span>
                            </button>
                        </td>
                    `;

                    orderTable.appendChild(row);


                    totalQuantity += item.quantity;
                    totalPrice += item.price * item.quantity;
                });


                document.getElementById('total-quantity').textContent = totalQuantity;
                document.getElementById('total-price').textContent = `$${totalPrice.toFixed(2)}`;
            }


            function adjustQuantity(productId, change) {
                const item = orderItems.find(item => item.id === productId);
                if (item) {
                    const newQuantity = item.quantity + change;
                    if (newQuantity >= 1) {
                        item.quantity = newQuantity;
                        updateOrderDisplay();
                    }
                }
            }


            function updateQuantity(productId, newQuantity) {
                const item = orderItems.find(item => item.id === productId);
                if (item) {
                    const quantity = parseInt(newQuantity);
                    if (!isNaN(quantity) && quantity >= 1) {
                        item.quantity = quantity;
                        updateOrderDisplay();
                    }
                }
            }


            function removeItem(productId) {
                orderItems = orderItems.filter(item => item.id !== productId);
                updateOrderDisplay();
            }


            function clearOrder() {
                orderItems = [];
                updateOrderDisplay();
            }


        </script>
</body>